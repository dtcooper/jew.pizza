{% extends 'admin_tools/base.html' %}

{% block extra_head %}
  <style>
    .state-running {
      color: forestgreen;
    }
    .state-exited, .state-dead, .state-destroyed {
      color: darkred;
    }
  </style>
{% endblock %}

{% block content %}
  {% if containers %}
    <form action="." method="POST">
      {{ csrf_input }}
      <table>
        <thead>
          <tr>
            <th>#</th>
            <th>Container</th>
            <th>Status</th>
            <th>CPU</th>
            <th>Memory</th>
            <th>Ports</th>
            <th>Restart</th>
            <th>Logs</th>
          </tr>
        </thead>
        <tbody>
          {% for name, state, ports, logs_url, cpu_info, mem_info in containers %}
            <tr>
              <td>{{ loop.index }}</td>
              <td>{{ name }}</td>
              <td class="state-{{ state }}">{{ state }}</td>
              <td>{% if cpu_info %}{{ cpu_info }}{% endif %}</td>
              <td>{% if mem_info %}{{ mem_info }}{% endif %}</td>
              <td>
                {% if ports %}
                  <ul>
                    {% for port in ports %}
                      <li>{{ port }}</li>
                    {% endfor %}
                  </ul>
                {% endif %}
              </td>
              <td>
                {% if state == 'running' and name != 'controller' %}
                  <button action="submit" name="container" value="{{ name }}">Restart</button>
                {% endif %}
              </td>
              <td>
                {% if logs_url %}
                  <a href="{{ logs_url }}" target="_blank">Logs</a>
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </form>
  {% else %}
    <em>No containers appear to be running!</em><br>
    The controller container may be down. Check server logs.
  {% endif %}
{% endblock %}
